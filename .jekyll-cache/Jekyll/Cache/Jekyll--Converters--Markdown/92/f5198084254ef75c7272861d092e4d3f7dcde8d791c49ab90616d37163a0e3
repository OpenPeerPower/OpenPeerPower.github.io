I"V<p>Our authentication system secures access to Open Peer Power.</p>
<p>If you are starting Open Peer Power for the first time, or you have logged out, you will be asked for credentials before you can log in.</p>
<img src='/images/docs/authentication/login.png' alt='Screenshot of the login screen' style='border: 0;box-shadow: none;'>
<h2>User accounts</h2>
<p>When you start Open Peer Power for the first time the <em>owner</em> user account is created. This account has some special privileges and can:</p>
<ul>
<li>Create and manage other user accounts.</li>
<li>Configure integrations and other settings (coming soon).</li>
</ul>
<div class='note'>
For the moment, other user accounts will have the same access as the owner account. In the future, non-owner accounts will be able to have restrictions applied.
</div>
<h3>Your Account Profile</h3>
<p>Once you’re logged in, you can see the details of your account at the <em>Profile</em> page by clicking on the circular badge next to the Open Peer Power title in the sidebar.</p>
<img src='/images/docs/authentication/profile.png' alt='Screenshot of the profile page' style='border: 0;box-shadow: none;'>
<p>You can:</p>
<ul>
<li>Change the language you prefer Open Peer Power to use.</li>
<li>Change your password.</li>
<li>Select the <a href="/integrations/frontend/#defining-themes">theme</a> for the interface of Open Peer Power.</li>
<li>Enable or disable <a href="/docs/authentication/multi-factor-auth/">multi-factor authentication</a>.</li>
<li>Delete <em>Refresh Tokens</em>. These are created when you log in from a device. Delete them if you want to force the device to log out.</li>
<li>Create so scripts can securely interact with Open Peer Power.</li>
<li>Log out of Open Peer Power.</li>
</ul>
<h3>Securing your login</h3>
<p><em>Make sure to choose a secure password!</em> At some time in the future, you will probably want to access Open Peer Power from outside your local network. This means you are also exposed to random black-hats trying to do the same. Treat the password like the key to your house.</p>
<p>As an extra level of security, you can turn on <a href="/docs/authentication/multi-factor-auth/">multi-factor authentication</a>.</p>
<h2>Other authentication techniques</h2>
<p>Open Peer Power provides several ways to authenticate. See the <a href="/docs/authentication/providers/">Auth Providers</a> section.</p>
<h2>Troubleshooting</h2>
<h3>Authentication failures from <code>127.0.0.1</code></h3>
<p>If you’re seeing authentication failures from <code>127.0.0.1</code> and you’re using the <code>nmap</code> device tracker, you should <a href="/integrations/nmap_tracker#exclude">exclude the Open Peer Power IP</a> from being scanned.</p>
<h3>Bearer token warnings</h3>
<p>Under the new authentication system you’ll see the following warning logged when the <a href="/docs/authentication/providers/#legacy-api-password">legacy API password</a> is supplied, but not configured in Open Peer Power:</p>
<figure class="highlight"><pre><code class="language-txt" data-lang="txt">WARNING (MainThread) [openpeerpower.components.http.auth] You need to use a bearer token to access /blah/blah from 192.0.2.4</code></pre></figure>
<p>If you see this, you need to add an <a href="/integrations/http/#api_password"><code>api_password</code></a> to your <code>http:</code> configuration.</p>
<h3>Bearer token informational messages</h3>
<p>If you see the following, then this is a message for integration developers, to tell them they need to update how they authenticate to Open Peer Power. As an end user you don’t need to do anything:</p>
<figure class="highlight"><pre><code class="language-txt" data-lang="txt">INFO (MainThread) [openpeerpower.components.http.auth] You need to use a bearer token to access /blah/blah from 192.0.2.4</code></pre></figure>
<h3>Lost owner password</h3>
<p>Before using the procedure below, make sure you explore options provided <a href="/docs/locked_out">here</a>.</p>
<p>While you should hopefully be storing your passwords in a password manager, if you lose the password associated with the owner account the only way to resolve this is to delete <em>all</em> the authentication data. You do this by shutting down Open Peer Power and deleting the following files from the <code>.storage/</code> folder in your <a href="/docs/configuration/">configuration folder</a>:</p>
<ul>
<li><code>auth</code></li>
<li><code>auth_provider.openpeerpower</code></li>
<li><code>onboarding</code></li>
<li><code>hassio</code></li>
<li><code>cloud</code></li>
</ul>
<p>When you start Open Peer Power next, you’ll be required to set up authentication again.</p>
<h3>Error: invalid client id or redirect URL</h3>
<img src='/images/docs/authentication/error-invalid-client-id.png' alt='Screenshot of Error: invalid client id or redirect url'>
<p>You have to use a domain name, not IP address, to remote access Open Peer Power otherwise you will get <code>Error: invalid client id or redirect url</code> error on the login form. However, you can use the IP address to access Open Peer Power in your home network.</p>
<p>This is because we only allow an IP address as a client ID when your IP address is an internal network address (e.g., <code>192.168.0.1</code>) or loopback address (e.g., <code>127.0.0.1</code>).</p>
<p>If you don’t have a valid domain name for your Open Peer Power instance, you can modify the <code>hosts</code> file on your computer to fake one. On Windows, edit the <code>C:\Windows\System32\Drivers\etc\hosts</code> file with administrator privilege, or on Linux the <code>/etc/hosts</code> file,  and add following entry:</p>
<figure class="highlight"><pre><code class="language-text" data-lang="text">12.34.56.78 openpeerpower.home</code></pre></figure>
<p>Replace <code>12.34.56.78</code> with your Open Peer Power’s public IP address.</p>
<p>This will allow you to open Open Peer Power at <code>http://openpeerpower.home:8123/</code></p>
<h3>Stuck on Loading data</h3>
<p>Some ad blocking software, such as Wipr, also blocks web sockets. If you’re stuck on the Loading data screen, try disabling your ad blocker.</p>
<h3>Migrating from pre 0.77</h3>
<p>If you were using the authentication system before 0.77, you’d likely have <code>auth:</code> and <code>auth_providers:</code> defined. You’ll need to remove these and let Open Peer Power <a href="/docs/authentication/providers/#configuring-auth-providers">handle it automatically</a>.</p>
:ET