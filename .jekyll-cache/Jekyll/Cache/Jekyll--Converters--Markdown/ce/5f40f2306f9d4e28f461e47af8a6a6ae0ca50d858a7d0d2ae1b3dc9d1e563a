I"<p>This installation of Open Peer Power Core requires the Raspberry Pi to run <a href="https://www.raspberrypi.org/downloads/raspbian/">Raspbian Lite</a>. The installation will be installed in a <a href="/docs/installation/virtualenv">Virtual Environment</a> with minimal overhead. Instructions assume this is a new installation of Raspbian Lite.</p>
<p>You must have Python 3.7 or later installed (including the package <code>python3-dev</code>) which is <em>not</em> the case for Raspbian Stretch.</p>
<div class='note'>
Although these installation steps specifically mention a Raspberry Pi, you can go ahead and proceed on any Linux install as well. This guide is also referred to as the "Advanced Guide" for a virtual environment install.
</div>
<div class='note warning'>
<p>Please remember to ensure you’re using an <a href="https://www.raspberrypi.org/documentation/faqs/#pi-power">appropriate power supply</a> with your Pi. Mobile chargers may not be suitable, since some are designed to only provide the full power with that manufacturer’s handsets. USB ports on your computer also will not supply enough power and must not be used.</p>
</div>
<p>Connect to the Raspberry Pi over SSH. Default password is <code>raspberry</code>.
You will need to enable SSH access. The Raspberry Pi website has instructions <a href="https://www.raspberrypi.org/documentation/remote-access/ssh/">here</a>.</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">$ ssh pi@ipaddress</code></pre></figure>
<p>Changing the default password is encouraged.</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">passwd</code></pre></figure>
<p>Update the system.</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">sudo apt-get update
sudo apt-get upgrade -y</code></pre></figure>
<p>Install the dependencies.</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">sudo apt-get install python3 python3-dev python3-venv python3-pip libffi-dev libssl-dev</code></pre></figure>
<p>Add an account for Open Peer Power Core called <code>openpeerpower</code>.
Since this account is only for running Open Peer Power Core the extra arguments of <code>-rm</code> is added to create a system account and create a home directory. The arguments <code>-G dialout,gpio,i2c</code> adds the user to the <code>dialout</code>, <code>gpio</code> and the <code>i2c</code> group. The first is required for using Z-Wave and Zigbee controllers, while the second is required to communicate with Raspberry’s GPIO.</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">sudo useradd -rm openpeerpower -G dialout,gpio,i2c</code></pre></figure>
<p>Next we will create a directory for the installation of Open Peer Power Core and change the owner to the <code>openpeerpower</code> account.</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">cd /srv
sudo mkdir openpeerpower
sudo chown openpeerpower:openpeerpower openpeerpower</code></pre></figure>
<p>Next up is to create and change to a virtual environment for Open Peer Power Core. This will be done as the <code>openpeerpower</code> account.</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">sudo -u openpeerpower -H -s
cd /srv/openpeerpower
python3 -m venv .
source bin/activate</code></pre></figure>
<p>Once you have activated the virtual environment (notice the prompt change to <code>(openpeerpower) openpeerpower@raspberrypi:/srv/openpeerpower $</code>) you will need to run the following command to install a required Python package.</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">python3 -m pip install wheel</code></pre></figure>
<p>Once you have installed the required Python package it is now time to install Open Peer Power Core!</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">pip3 install openpeerpower</code></pre></figure>
<p>Start Open Peer Power Core for the first time. This will complete the installation for you, automatically creating the <code>.openpeerpower</code> configuration directory in the <code>/home/openpeerpower</code> directory, and installing any basic dependencies.</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">hass</code></pre></figure>
<p>You can now reach your installation on your Raspberry Pi over the web interface on <code>http://ipaddress:8123</code>.</p>
<div class='note'>
<p>When you run the <code>hass</code> command for the first time, it will download, install and cache the necessary libraries/dependencies. This procedure may take anywhere between 5 to 10 minutes. During that time, you may get “site cannot be reached” error when accessing the web interface. This will only happen for the first time, and subsequent restarts will be much faster.</p>
</div>
<p>If you want to setup <code>hass</code> as a daemon and autostart it on boot please refer to <a href="/docs/autostart/">Autostart Open Peer Power Core</a>.</p>
<h3>Updating</h3>
<p>To update to the latest version of Open Peer Power Core follow these simple steps:</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">sudo -u openpeerpower -H -s
source /srv/openpeerpower/bin/activate
pip3 install --upgrade openpeerpower</code></pre></figure>
<p>Once the last command executes, restart the Open Peer Power Core service to apply the latest updates. Please keep in mind that some updates may take longer to start up than others. If Open Peer Power Core fails to start, make sure you check the <strong>Breaking Changes</strong> from the <a href="https://github.com/OpenPeerPower/Open-Peer-Power/releases">Release Notes</a>.</p>
<h3>Run a specific version</h3>
<p>In the event that a Open Peer Power Core version doesn’t play well with your hardware setup, you can downgrade to a previous release. For example:</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">sudo -u openpeerpower -H -s
source /srv/openpeerpower/bin/activate
pip3 install openpeerpower==0.XX.X</code></pre></figure>
<h3>Run the beta version</h3>
<p>If you would like to test next release before anyone else, you can install the beta version released every two weeks, for example:</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">sudo -u openpeerpower -H -s
source /srv/openpeerpower/bin/activate
pip3 install --pre --upgrade openpeerpower</code></pre></figure>
<h3>Run the development version</h3>
<p>If you want to stay on the bleeding-edge Open Peer Power Core development branch, you can upgrade to <code>dev</code>.</p>
<div class='note warning'>
  The "dev" branch is likely to be unstable. Potential consequences include loss of data and instance corruption.
</div>
<p>For example:</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">sudo -u openpeerpower -H -s
source /srv/openpeerpower/bin/activate
pip3 install --upgrade git+git://github.com/OpenPeerPower/Open-Peer-Power.git@dev</code></pre></figure>
<h3>Activating the virtual environment</h3>
<p>When instructions tell you to activate the virtual environment, the following commands will do this:</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">sudo -u openpeerpower -H -s
source /srv/openpeerpower/bin/activate</code></pre></figure>
:ET