I"<p>The <code>script</code> integration allows users to specify a sequence of actions to be executed by Open Peer Power. These are run when you turn the script on. The script integration will create an entity for each script and allow them to be controlled via services.</p>
<h2>Configuration</h2>
<p>The sequence of actions is specified using the <a href="/getting-started/scripts/">Open Peer Power Script Syntax</a>.</p>
<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"># Example configuration.yaml entry
script:
  message_temperature:
    sequence:
      # This is Open Peer Power Script Syntax
      - service: notify.notify
        data_template:
          message: Current temperature is {{ states(&#39;sensor.temperature&#39;) }}</code></pre></figure>
<div class='note'>
<p>Script names (e.g., <code>message_temperature</code> in the example above) are not allowed to contain capital letters, or dash (minus) characters, i.e., <code>-</code>. The preferred way to separate words for better readability is to use underscore (<code>_</code>) characters.</p>
</div>
<h3>Full Configuration</h3>
<p>{% highlight yaml %}
script: 
wakeup:
alias: Wake Up
icon: “mdi:party-popper”
description: ‘Turns on the bedroom lights and then the living room lights after a delay’
fields:
minutes:
description: ‘The amount of time to wait before turning on the living room lights’
example: 1
sequence:
# This is Open Peer Power Script Syntax
- event: LOGBOOK_ENTRY
event_data:
name: Paulus
message: is waking up
entity_id: device_tracker.paulus
domain: light
- alias: Bedroom lights on
service: light.turn_on
data:
entity_id: group.bedroom
brightness: 100
- delay:
# supports seconds, milliseconds, minutes, hours
minutes: {{ minutes }}
- alias: Living room lights on
service: light.turn_on
data:
entity_id: group.living_room
{% endhighlight %}</p>
<h3>Passing variables to scripts</h3>
<p>As part of the service, variables can be passed along to a script so they become available within templates in that script.</p>
<p>There are two ways to achieve this. One way is using the generic <code>script.turn_on</code> service. To pass variables to the script with this service, call it with the desired variables:</p>
<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"># Example configuration.yaml entry
automation:
  trigger:
    platform: state
    entity_id: light.bedroom
    from: &#39;off&#39;
    to: &#39;on&#39;
  action:
    service: script.turn_on
    entity_id: script.notify_pushover
    data:
      variables:
        title: &#39;State change&#39;
        message: &#39;The light is on!&#39;</code></pre></figure>
<p>The other way is calling the script as a service directly. In this case, all service data will be made available as variables. If we apply this approach on the script above, it would look like this:</p>
<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"># Example configuration.yaml entry
automation:
  trigger:
    platform: state
    entity_id: light.bedroom
    from: &#39;off&#39;
    to: &#39;on&#39;
  action:
    service: script.notify_pushover
    data:
      title: &#39;State change&#39;
      message: &#39;The light is on!&#39;</code></pre></figure>
<p>Using the variables in the script requires the use of <code>data_template</code>:</p>
<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"># Example configuration.yaml entry
script:
  notify_pushover:
    description: &#39;Send a pushover notification&#39;
    fields:
      title:
        description: &#39;The title of the notification&#39;
        example: &#39;State change&#39;
      message:
        description: &#39;The message content&#39;
        example: &#39;The light is on!&#39;
    sequence:
      - condition: state
        entity_id: switch.pushover_notifications
        state: &#39;on&#39;
      - service: notify.pushover
        data_template:
          title: &quot;{{ title }}&quot;
          message: &quot;{{ message }}&quot;</code></pre></figure>
<h3>In the Overview</h3>
<p>Scripts in the Overview panel will be displayed with an <strong>EXECUTE</strong> button if the device has no <code>delay:</code> or <code>wait:</code> statement, and as a toggle switch if it has either of those.</p>
<p>This is to enable you to stop a running script.</p>
:ET